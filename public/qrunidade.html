<!DOCTYPE html>
<html>
    <head>
        <title>Registre um Qr da sua comanda !</title>

    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script type="text/javascript" src="/js/jquery.qrcode.min.js"></script>

    <script type="module">
        import QrScanner from "/qr/qr-scanner.min.js";
        const video = document.getElementById('qr-video');
        const debugCheckbox = document.getElementById('debug-checkbox');
        const debugCanvas = document.getElementById('debug-canvas');
        const debugCanvasContext = debugCanvas.getContext('2d');
        const camQrResult = document.getElementById('cam-qr-result');
        const fileSelector = document.getElementById('file-selector');
        const fileQrResult = document.getElementById('file-qr-result');

        function setResult(label, result) {
            var comanda = result.split("-");
         //   alert("Sua comando Ã© a "+comanda[1]);
            localStorage.setItem("loja",comanda[0]);
            localStorage.setItem("comanda",comanda[1]);
            localStorage.setItem('BENJAMIN_SHOP',comanda[0]);

            window.location.replace("/pocket.html");
           
        }

        const scanner = new QrScanner(video, result => setResult(camQrResult, result));
        scanner.start();

        function setDebugMode(isDebug) {
            const worker = scanner._qrWorker;
            worker.postMessage({
                type: 'setDebug',
                data: isDebug
            });
            if (isDebug) {
                debugCanvas.style.display = 'block';
                worker.addEventListener('message', handleDebugImage);
            } else {
                debugCanvas.style.display = 'none';
                worker.removeEventListener('message', handleDebugImage);
            }
        }

        function handleDebugImage(event) {
            const type = event.data.type;
            if (type === 'debugImage') {
                const imageData = event.data.data;
                if (debugCanvas.width !== imageData.width || debugCanvas.height !== imageData.height) {
                    debugCanvas.width = imageData.width;
                    debugCanvas.height = imageData.height;
                }
                debugCanvasContext.putImageData(imageData, 0, 0);
            }
        }
    </script>


    </head>
    <body>
        <center>
            <video muted autoplay playsinline id="qr-video" width="200px"></video>
        </center>
        <canvas id="debug-canvas">
            
        </canvas>

        <center><div id="qrcode" ></div></center>


    </body>
</html>
    	
 